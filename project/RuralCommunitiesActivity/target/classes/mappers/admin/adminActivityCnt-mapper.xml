<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.javajo.sunshineRoad.mappers.admin.AdminActivityCntMapper">

	<select id="getTotalCount" resultType="int">
	SELECT COUNT(*) FROM ACTIVITY_INFO
	</select>
	
	<select id="selectStartDateActivityCnt" parameterType="ASearch" resultType="int">
	SELECT COUNT(*) FROM ACTIVITY_INFO
	WHERE A_START_DATE BETWEEN
	TO_TIMESTAMP(#{startDate}, 'YYYY-MM-DD HH24:MI:SS.xff') 
	AND TO_TIMESTAMP(#{endDate}, 'YYYY-MM-DD HH24:MI:SS.xff')
	</select>	

	<select id="selectEndDateActivityCnt" parameterType="ASearch" resultType="int">
	SELECT COUNT(*) FROM ACTIVITY_INFO
	WHERE A_END_DATE BETWEEN
	TO_TIMESTAMP(#{startDate}, 'YYYY-MM-DD HH24:MI:SS.xff') 
	AND TO_TIMESTAMP(#{endDate}, 'YYYY-MM-DD HH24:MI:SS.xff')
	</select>	
	
	<select id="selectDateReservationCnt" parameterType="ASearch" resultType="int">
	SELECT COUNT(*) FROM ACTIVITY_INFO
	WHERE A_RESERVATION_DEADLINE BETWEEN
	TO_TIMESTAMP(#{startDate}, 'YYYY-MM-DD HH24:MI:SS.xff') 
	AND TO_TIMESTAMP(#{endDate}, 'YYYY-MM-DD HH24:MI:SS.xff')
	</select>		
		
	<select id="SelectActivityCnt" parameterType="ASearch" resultType="int">
	SELECT COUNT(*) FROM (
	SELECT A_ID, S_ID, SIGUNGU_ID, 
    A_THEME_ID, A_START_DATE, A_END_DATE, A_ADDR, 
    A_NAME, A_ONE_LINER, A_MIN_PEOPLE, A_MAX_PEOPLE,
    A_CHARGE, S_SITE, A_RESERVATION_DEADLINE 
    FROM ACTIVITY_INFO
	WHERE A_NAME LIKE '%'||#{keyword}||'%' AND A_NAME IS NOT NULL
	UNION
	SELECT A_ID, S_ID, SIGUNGU_ID, 
    A_THEME_ID, A_START_DATE, A_END_DATE, A_ADDR, 
    A_NAME, A_ONE_LINER, A_MIN_PEOPLE, A_MAX_PEOPLE,
    A_CHARGE, S_SITE, A_RESERVATION_DEADLINE 
    FROM ACTIVITY_INFO
	WHERE A_CHARGE <![CDATA[>=]]> #{charge}
	UNION
	SELECT A_ID, S_ID, SIGUNGU_ID, 
    A_THEME_ID, A_START_DATE, A_END_DATE, A_ADDR, 
    A_NAME, A_ONE_LINER, A_MIN_PEOPLE, A_MAX_PEOPLE,
    A_CHARGE, S_SITE, A_RESERVATION_DEADLINE 
    FROM ACTIVITY_INFO
	WHERE A_THEME_ID=#{theme}
	UNION
	SELECT A.A_ID, A.S_ID, A.SIGUNGU_ID, 
    A.A_THEME_ID, A.A_START_DATE, A.A_END_DATE, A.A_ADDR, 
    A.A_NAME, A.A_ONE_LINER, A.A_MIN_PEOPLE, A.A_MAX_PEOPLE,
    A.A_CHARGE, A.S_SITE, A.A_RESERVATION_DEADLINE 
    FROM ACTIVITY_INFO A INNER JOIN
	REGION_SIGUNGU R ON A.SIGUNGU_ID = R.SIGUNGU_ID
	WHERE R.SIDO_ID=#{sido}
	UNION
	SELECT A.A_ID, A.S_ID, A.SIGUNGU_ID, 
    A.A_THEME_ID, A.A_START_DATE, A.A_END_DATE, A.A_ADDR, 
    A.A_NAME, A.A_ONE_LINER, A.A_MIN_PEOPLE, A.A_MAX_PEOPLE,
    A.A_CHARGE, A.S_SITE, A.A_RESERVATION_DEADLINE 
    FROM ACTIVITY_INFO A INNER JOIN
	REGION_SIGUNGU R ON A.SIGUNGU_ID = R.SIGUNGU_ID
	WHERE A.SIGUNGU_ID=#{sigungu}
	)
	</select>
				
</mapper>