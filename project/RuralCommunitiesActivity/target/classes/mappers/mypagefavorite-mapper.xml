<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.javajo.sunshineRoad.mappers.mypageMember.MypageFavoriteMapper">

	<resultMap type="MypageFavoriteDTO" id="favoriteByMember">
		<id column="f_id" property="fId" />
		<result column="board_id" property="boardId" />
		<association property="activityInfo"
			javaType="MypageActivityInfoDTO">
			<result column="a_name" property="aName" />
			<result column="a_one_liner" property="aOneLiner" />
			<result column="a_thumbnail_img" property="aThumbnailImg" />
		</association>
		<association property="mypageEvent"
			javaType="MypageEventDTO">
			<result column="event_name" property="eventName" />
			<result column="event_thumbnail_img"
				property="eventThumbnailImg" />
			<result column="event_addr" property="eventAddr" />
		</association>
	</resultMap>

	<select id="selectCount" parameterType="int"
		resultType="int">
		SELECT
		COUNT(*)
		FROM
		(SELECT F_ID, BOARD_ID FROM FAVORITE WHERE U_ID = #{uId}) F
		JOIN
		BOARD_LIST B ON (F.BOARD_ID = B.BOARD_ID)
		LEFT JOIN ACTIVITY_POST P ON
		(B.A_POST_ID = P.A_POST_ID)
		LEFT JOIN ACTIVITY_INFO I ON (P.A_ID =
		I.A_ID)
		LEFT JOIN EVENT E ON (B.EVENT_ID = E.EVENT_ID)
	</select>
	
	
	<select id="selectByFavoriteList" parameterType="int"
		resultType="int">
		SELECT
		F.F_ID,
		F.BOARD_ID,
		I.A_NAME,
		I.A_ONE_LINER,
		I.A_THUMBNAIL_IMG,
		E.EVENT_ADDR,
		E.EVENT_NAME,
		E.EVENT_THUMBNAIL_IMG
		FROM
		(SELECT F_ID, BOARD_ID FROM FAVORITE WHERE U_ID = #{uId}) F
		JOIN
		BOARD_LIST B ON (F.BOARD_ID = B.BOARD_ID)
		LEFT JOIN ACTIVITY_POST P ON
		(B.A_POST_ID = P.A_POST_ID)
		LEFT JOIN ACTIVITY_INFO I ON (P.A_ID =
		I.A_ID)
		LEFT JOIN EVENT E ON (B.EVENT_ID = E.EVENT_ID)
	</select>
	

	<select id="selectByMember" parameterType="int"
		resultMap="favoriteByMember">
		SELECT
		F.F_ID,
		F.BOARD_ID,
		I.A_NAME,
		I.A_ONE_LINER,
		I.A_THUMBNAIL_IMG,
		E.EVENT_ADDR, 
		E.EVENT_NAME,
		E.EVENT_THUMBNAIL_IMG
		FROM
		(SELECT F_ID, BOARD_ID FROM FAVORITE WHERE U_ID = #{uId}) F
		JOIN
		BOARD_LIST B ON (F.BOARD_ID = B.BOARD_ID)
		LEFT JOIN ACTIVITY_POST P ON
		(B.A_POST_ID = P.A_POST_ID)
		LEFT JOIN ACTIVITY_INFO I ON (P.A_ID =
		I.A_ID)
		LEFT JOIN EVENT E ON (B.EVENT_ID = E.EVENT_ID)
	</select>

</mapper>