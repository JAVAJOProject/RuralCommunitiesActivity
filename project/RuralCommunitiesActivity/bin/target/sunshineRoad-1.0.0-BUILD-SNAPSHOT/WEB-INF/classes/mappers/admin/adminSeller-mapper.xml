<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
"-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.javajo.sunshineRoad.mappers.admin.AdminSellerMapper">


	<select id="getAllSeller" resultType="ASeller">
		SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
	S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
	S_REG_NUM, S_MARKETING_CONSENT,
	S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
	FROM (SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
		SEQ,
		S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
		S_REG_NUM, S_MARKETING_CONSENT,
		S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
		FROM (SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
			ROWNUM AS SEQ,
			S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
			S_REG_NUM, S_MARKETING_CONSENT,
			S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
			FROM (SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
				S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
				S_REG_NUM, S_MARKETING_CONSENT,
				S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
				FROM SELLER 
				ORDER BY S_ID)
	    		)
    		WHERE seq <![CDATA[>=]]> #{startPostNo}
    	)
    	WHERE ROWNUM <![CDATA[<=]]> #{endPostNo}  
	</select>
	
	<select id="selectSellerIDAdmin" parameterType="int" resultType="ASeller">
	SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
	S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
	S_REG_NUM, S_MARKETING_CONSENT,
	S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
	FROM SELLER WHERE S_ID=#{sId}
	</select>
	
	<select id="selectSellerDATE" resultType="ASeller">
		SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
	S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
	S_REG_NUM, S_MARKETING_CONSENT,
	S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
	FROM (SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
		SEQ,
		S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
		S_REG_NUM, S_MARKETING_CONSENT,
		S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
		FROM (SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
			ROWNUM AS SEQ,
			S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
			S_REG_NUM, S_MARKETING_CONSENT,
			S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
			FROM (SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
				S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
				S_REG_NUM, S_MARKETING_CONSENT,
				S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
				FROM SELLER 
				WHERE S_REG_DATE BETWEEN 
				TO_TIMESTAMP(#{searchDTO.startDate}, 'YYYY-MM-DD HH24:MI:SS.xff') 
				AND TO_TIMESTAMP(#{searchDTO.endDate}, 'YYYY-MM-DD HH24:MI:SS.xff')
				ORDER BY S_ID)
	    		)
    		WHERE seq <![CDATA[>=]]> #{startPostNo}
    	)
    	WHERE ROWNUM <![CDATA[<=]]> #{endPostNo}  
	</select>
	
	<update id="updateSellerAdmin" parameterType="ASeller">
	UPDATE SELLER SET
	S_COM_NAME=#{sComName},
	S_REP_NAME=#{sRepName},
	S_TEL=#{sTel},
	S_REG_NUM=#{sRegNum},
	S_PW=#{sPw},
	S_ADDR=#{sAddr}
	WHERE S_ID=#{sId}
	</update>


	<delete id="delSellerAdmin" parameterType="int">
	DELETE FROM SELLER WHERE S_ID=#{sId}
	</delete>
	
	<select id="appSeller" resultType="ASeller">
		SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
	S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
	S_REG_NUM, S_MARKETING_CONSENT,
	S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
	FROM (SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
		SEQ,
		S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
		S_REG_NUM, S_MARKETING_CONSENT,
		S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
		FROM (SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
			ROWNUM AS SEQ,
			S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
			S_REG_NUM, S_MARKETING_CONSENT,
			S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
			FROM (SELECT S_ID, ACCOUNT_INFO_ID, MEM_TYPE_ID, 
				S_EMAIL, S_COM_NAME, S_TEL, S_REG_DATE, S_ADDR, 
				S_REG_NUM, S_MARKETING_CONSENT,
				S_APPROVAL, S_REP_NAME, S_REG_CERTIFICATE_IMG 
				FROM SELLER 
				WHERE S_APPROVAL = 0
				ORDER BY S_ID)
	    		)
    		WHERE seq <![CDATA[>=]]> #{startPostNo}
    	)
    	WHERE ROWNUM <![CDATA[<=]]> #{endPostNo}  				
	</select>
	
	<update id="updateAppAdmin" parameterType="int">
	UPDATE SELLER SET
	S_APPROVAL=1
	WHERE S_ID=#{sId}
	</update>
	
	<resultMap type="ASCommunity" id="ASCommunityMap">
		<result column="SELLER_COMMUNITY_CONTENT" property="sellerCommunityContent"/>
		<result column="SELLER_COMMUNITY_FAVORITE_CNT" property="sellerCommunityFavoriteCnt"/>
		<result column="SELLER_COMMUNITY_DATE_CREATED" property="sellerCommunityDateCreated"/>
		<collection property="postTypeDTO" resultMap="PostType" />
	</resultMap>
	
	<resultMap type="APostType" id="APostTypeMap">
		<result column="POST_TYPE_ID" property="postTypeId"/>
		<result column="POST_TYPE_NAME" property="postTypeName"/>
	</resultMap>
	
	<select id="wrotePost" parameterType="int" resultMap="ASCommunityMap">
		SELECT SELLER_COMMUNITY_POST_ID, S_ID,
		POST_TYPE_ID, SELLER_COMMUNITY_CONTENT, 
		SELLER_COMMUNITY_DATE_CREATED, COMMUNITY_LIKE_CNT,
		COMMUNITY_CUM_CNT, COMMUNITY_VIEW_CNT
		FROM (SELECT SELLER_COMMUNITY_POST_ID, S_ID,
			SEQ,
            POST_TYPE_ID, SELLER_COMMUNITY_CONTENT, 
			SELLER_COMMUNITY_DATE_CREATED, COMMUNITY_LIKE_CNT,
			COMMUNITY_CUM_CNT, COMMUNITY_VIEW_CNT
			FROM (SELECT SELLER_COMMUNITY_POST_ID, S_ID,
				ROWNUM AS SEQ,
                POST_TYPE_ID, SELLER_COMMUNITY_CONTENT, 
				SELLER_COMMUNITY_DATE_CREATED, COMMUNITY_LIKE_CNT,
				COMMUNITY_CUM_CNT, COMMUNITY_VIEW_CNT
				FROM (SELECT 
					S.SELLER_COMMUNITY_POST_ID, S.S_ID,
					S.POST_TYPE_ID, S.SELLER_COMMUNITY_CONTENT, 
					S.SELLER_COMMUNITY_DATE_CREATED, S.COMMUNITY_LIKE_CNT,
					S.COMMUNITY_CUM_CNT, S.COMMUNITY_VIEW_CNT
					FROM SELLER_COMMUNITY S LEFT OUTER JOIN POST_TYPE P 
					ON S.POST_TYPE_ID = P.POST_TYPE_ID 
					WHERE S_ID=#{sId}
					ORDER BY S.SELLER_COMMUNITY_DATE_CREATED )
	    		)
    		WHERE seq <![CDATA[>=]]> #{startPostNo}
    	)
    	WHERE ROWNUM <![CDATA[<=]]> #{endPostNo}  	
    	</select>
	
</mapper>